export struct SocialStatusEntry {
    id: int,
    name: string,
    description: string,
    icon: string,
    color: color,
}

export global SocialStatusState {
    in-out property <int> current-status: 0;
    in-out property <bool> dropdown-open: false;
    in-out property <bool> enabled: true;
    
    out property <[SocialStatusEntry]> status-options: [
        { id: 0, name: "Online",         description: "Available for interaction",    icon: "●", color: #22c55e },
        { id: 1, name: "Do Not Disturb", description: "Busy - please don't message",  icon: "⊘", color: #ef4444 },
        { id: 2, name: "Day Dreaming",   description: "Away from keyboard",           icon: "☽", color: #eab308 },
        { id: 3, name: "Need Group",     description: "Looking for a group",          icon: "⚑", color: #3b82f6 },
        { id: 4, name: "Grouped",        description: "Already in a group",           icon: "⚐", color: #8b5cf6 },
        { id: 5, name: "Lone Hunter",    description: "Hunting solo",                 icon: "◆", color: #6366f1 },
        { id: 6, name: "Group Hunting",  description: "Hunting with group",           icon: "◇", color: #ec4899 },
        { id: 7, name: "Need Help",      description: "Requesting assistance",        icon: "?", color: #f97316 },
    ];
    
    callback set-status(int);
    callback dropdown-opened();
    callback dropdown-closed();
    
    public pure function get-current() -> SocialStatusEntry {
        return status-options[clamp(current-status, 0, 7)];
    }
    
    public pure function get-by-id(id: int) -> SocialStatusEntry {
        return status-options[clamp(id, 0, 7)];
    }
    
    public pure function is-away(status-id: int) -> bool {
        return status-id == 2;
    }
    
    public pure function is-busy(status-id: int) -> bool {
        return status-id == 1;
    }
    
    public pure function is-lfg(status-id: int) -> bool {
        return status-id == 3;
    }
    
    public function close-dropdown() {
        if dropdown-open {
            dropdown-open = false;
            dropdown-closed();
        }
    }
    
    public function toggle-dropdown() {
        dropdown-open = !dropdown-open;
        if dropdown-open {
            dropdown-opened();
        } else {
            dropdown-closed();
        }
    }
}
